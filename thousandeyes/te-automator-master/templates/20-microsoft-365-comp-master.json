{
  "name": "Microsoft 365 End User Experience - Comprehensive",
  "description": "Setup testing of Microsoft 365 Tenant",
  "logo_url": "assets/img/brand/o365-logo.png",
  "service": "sharepoint",
  "formVariables": {
    "$formMicrosoftTenant": {
      "name": "Microsoft 365 Tenant Name (e.g. cisco)",
      "type": "text"
    },
    "$formOfficeAppURL": {
      "name": "Choose an Office App",
      "type": "object",
      "options": {
        "https://excel.office.com":"Excel",
        "https://powerpoint.office.com":"Powerpoint",
        "https://word.office.com":"Word"
      },
        "selected": "https://excel.office.com"
    },
    "$formUsername": {
      "name": "MS365 Username",
      "type": "text"
    },
    "$formPassword": {
      "name": "MS365 Password",
      "type": "password"
    },
    "$formSharepointFile": {
      "name": "Filename for Sharepoint Download Test",
      "type": "text"
    },
    "$formAgents": {
      "name": "Agents",
      "type": "agents"
    },
    "$formTestInterval": {
      "name": "Microsoft 365 Test Interval",
      "type": "object",
      "options": {
        "300": "Critical - 5 min",
        "600": "  Normal - 10 min",
        "900": " Relaxed - 15 min"
      },
      "selected": 600
    }
  },
  "create": {
    "alertRules": [
      {
        "alertType": "Web Transactions",
        "default": 0,
        "expression": "((duration >= 20000 ms))",
        "minimumSources": 1,
        "notifyOnClear": 1,
        "roundsViolatingOutOf": 3,
        "roundsViolatingRequired": 3,
        "roundsViolatingMode": "EXACT",
        "ruleName": "Microsoft Online Login Transaction Alert Rule"
      },
      {
        "alertType": "BGP",
        "default": 0,
        "expression": "[(locationId !in {\"8673\"}) && (((prefixLengthIPv4 >= 16) && (prefixLengthIPv4 <= 32)) || ((prefixLengthIPv6 >= 32) && (prefixLengthIPv6 <= 128)))]((reachability < 90%) || (changes > 3))",
        "minimumSources": 1,
        "notifyOnClear": 1,
        "roundsViolatingOutOf": 3,
        "roundsViolatingRequired": 3,
        "roundsViolatingMode": "EXACT",
        "ruleName": "MS365 BGP Alert Rule"
      },
      {
        "alertType":"DNS Trace",
        "default":0,
        "expression":"((probDetail != \"\"))",
        "minimumSources":1,
        "notifyOnClear":1,
        "roundsViolatingOutOf":3,
        "roundsViolatingRequired":3,
        "roundsViolatingMode":"EXACT",
        "ruleName":"MS365 DNS Server Alert Rule"
      },
      {
        "alertType": "HTTP Server",
        "default": 0,
        "expression": "((responseTime >= 2000 ms))",
        "minimumSources": 1,
        "notifyOnClear": 1,
        "roundsViolatingOutOf": 3,
        "roundsViolatingRequired": 3,
        "roundsViolatingMode": "EXACT",
        "ruleName": "MS365 HTTP Server Alert Rule"
      },
      {
        "alertType": "End-to-End (Server)",
        "default": 0,
        "expression": "((jitter >= 30 ms))",
        "minimumSources": 1,
        "notifyOnClear": 1,
        "roundsViolatingOutOf": 3,
        "roundsViolatingRequired": 3,
        "roundsViolatingMode": "EXACT",
        "ruleName": "MS365 Jitter"
      },
      {
        "alertType": "End-to-End (Server)",
        "default": 0,
        "expression": "((avgLatency >= 100 ms))",
        "minimumSources": 1,
        "notifyOnClear": 1,
        "roundsViolatingOutOf": 3,
        "roundsViolatingRequired": 3,
        "roundsViolatingMode": "EXACT",
        "ruleName": "MS365 Latency"
      },
      {
        "alertType": "End-to-End (Server)",
        "default": 0,
        "expression": "((loss >= 10%))",
        "minimumSources": 1,
        "notifyOnClear": 1,
        "roundsViolatingOutOf": 3,
        "roundsViolatingRequired": 3,
        "roundsViolatingMode": "EXACT",
        "ruleName": "MS365 Packet Loss"
      },
      {
        "alertType": "Web Transactions",
        "default": 0,
        "expression": "((duration >= 20000 ms))",
        "minimumSources": 1,
        "notifyOnClear": 1,
        "roundsViolatingOutOf": 3,
        "roundsViolatingRequired": 3,
        "roundsViolatingMode": "EXACT",
        "ruleName": "Office Application Login Transaction Alert Rule"
      },
      {
        "alertType": "Web Transactions",
        "default": 0,
        "expression": "((duration >= 40000 ms))",
        "minimumSources": 1,
        "notifyOnClear": 1,
        "roundsViolatingOutOf": 3,
        "roundsViolatingRequired": 3,
        "roundsViolatingMode": "EXACT",
        "ruleName": "OneDrive File Download Transaction Alert Rule"
      },
      {
        "alertType": "Web Transactions",
        "default": 0,
        "expression": "((duration >= 30000 ms))",
        "minimumSources": 1,
        "notifyOnClear": 1,
        "roundsViolatingOutOf": 3,
        "roundsViolatingRequired": 3,
        "roundsViolatingMode": "EXACT",
        "ruleName": "OneNote Application Login Transaction Alert Rule"
      },
      {
        "alertType": "Web Transactions",
        "default": 0,
        "expression": "((duration >= 50000 ms))",
        "minimumSources": 1,
        "notifyOnClear": 1,
        "roundsViolatingOutOf": 3,
        "roundsViolatingRequired": 3,
        "roundsViolatingMode": "EXACT",
        "ruleName": "Outlook Send Mail Transaction Alert Rule"
      },
      {
        "alertType": "Web Transactions",
        "default": 0,
        "expression": "((duration >= 40000 ms))",
        "minimumSources": 1,
        "notifyOnClear": 1,
        "roundsViolatingOutOf": 3,
        "roundsViolatingRequired": 3,
        "roundsViolatingMode": "EXACT",
        "ruleName": "Sharepoint File Download Transaction Alert Rule"
      }
    ],
    "labels": [
      {
        "name": "OneDrive Online",
        "type": "tests"
      },
      {
        "name": "DNS Resolution to Microsoft Online",
        "type": "tests"
      },
      {
        "name": "Microsoft 365 Online",
        "type": "tests"
      },
      {
        "name": "Office Online",
        "type": "tests"
      },
      {
        "name": "OneNote Online",
        "type": "tests"
      },
      {
        "name": "Outlook Online",
        "type": "tests"
      },
      {
        "name": "Sharepoint Online",
        "type": "tests"
      },
      {
        "name": "Branch",
        "type": "agents",
        "agents": "$formAgents"
      }
    ],
    "credentials": [
      {
        "name": "MS365_email",
        "value": "$formUsername"
      },
      {
        "name": "MS365_password",
        "value": "$formPassword"
      },
      {
        "name": "MS365_filename",
        "value": "$formSharepointFile"
      },
      {
        "name": "MS365_recipient",
        "value": "$formUsername"
      }
    ],
    "tests": [
      {
        "agents": "$formAgents",
        "enabled":1,
        "testName":"DNS Trace to Microsoft 365",
        "type":"dns-trace",
        "interval":"$formTestInterval",
        "domain":"login.microsoftonline.com A",
        "dnsQueryClass":"IN",
        "dnsTransportProtocol":"UDP",
        "alertsEnabled":1,
        "liveShare":0,
        "alertRules": [
          "MS365 DNS Server Alert Rule"
          ],
        "groups":  [
            "DNS Resolution to Microsoft Online"
          ]
      },
      {
        "agents": "$formAgents",
        "enabled": 1,
        "testName": "Office Application Login",
        "type": "web-transactions",
        "interval": "$formTestInterval",
        "subinterval": "$formTestInterval",
        "url": "$formOfficeAppURL",
        "protocol": "TCP",
        "networkMeasurements": 1,
        "mtuMeasurements": 1,
        "bandwidthMeasurements": 0,
        "bgpMeasurements": 1,
        "usePublicBgp": 1,
        "alertsEnabled": 1,
        "alertRules": [
          "MS365 BGP Alert Rule",
          "MS365 HTTP Server Alert Rule",
          "MS365 Jitter",
          "MS365 Latency",
          "MS365 Packet Loss",
          "Office Application Login Transaction Alert Rule"
        ],
        "timeLimit": 20,
        "targetTime": 15,
        "httpTimeLimit": 5,
        "httpTargetTime": 1000,
        "httpVersion": 2,
        "followRedirects": 0,
        "includeHeaders": 1,
        "sslVersionId": 0,
        "verifyCertificate": 1,
        "useNtlm": 0,
        "authType": "NONE",
        "contentRegex": "",
        "transactionScript": "import { By, Key, until } from 'selenium-webdriver';\nimport { driver, credentials, markers, test } from 'thousandeyes';\n\n\nrunScript();\n\nlet email = credentials.get('MS365_email'); // '<<email>>';\nlet password = credentials.get('MS365_password'); // '<<credentialsName>>';\n\n\nasync function runScript() {\n  await configureDriver();\n  await configureDriver();\n let testSettings = test.getSettings();\n\n\n await driver.takeScreenshot();\n\n\n markers.start('Login');\n  await driver.get(testSettings.url);\n\n  await typeText(email, By.id(`i0116`));\n\n  await click(By.id(`idSIButton9`));\n  await driver.wait(until.elementIsVisible(driver.findElement(By.xpath(`//*[@id=\"loginHeader\"]//*[text()=\"Enter password\"]`))))\n\n await typeText(password, By.id(`i0118`));\n\n  await click(By.id(`idSIButton9`));\n\n  await click(By.id(`idBtn_Back`));\n\n markers.stop('Login');\n}\n\nasync function clickText(text) {\n await click(By.xpath(`//*[text()=\"${text}\"]`));\n}\n\n async function configureDriver() {\n  await driver.manage().window().setRect({\n    width:1200,\n     height: 1049 });\n\n     await driver.manage().setTimeouts({\n       implicit: 7 * 1000 // If an element is not found, reattempt for this many milliseconds\n});\n}\n\n\n\n  async function typeText(value, selector) {\n     await simulateHumanDelay();\n     const element = await driver.findElement(selector);\n     await element.clear();\n     await element.sendKeys(value);\n}\n\n    async function simulateHumanDelay() {\n     await driver.sleep(550);\n}\n\n     async function click(selector) {\n      await simulateHumanDelay();\n\n      const configuredTimeouts = await driver.manage().getTimeouts();\n       const clickAttemptEndTime = Date.now() + configuredTimeouts.implicit;\n\n      await reattemptUntil(attemptToClick, clickAttemptEndTime);\n\n      async function attemptToClick() {\n       await driver.findElement(selector).\n       click();\n    }\n   }\n\n    async function reattemptUntil(attemptActionFn, attemptEndTime) {\n      const TIME_BETWEEN_ATTEMPTS = 100;\n      let numberOfAttempts = 0;\n      let attemptError;\n      while (Date.now() < attemptEndTime || numberOfAttempts === 0) {\n        try {\n          numberOfAttempts += 1;\n          await attemptActionFn();\n        }\n        catch (error) {\n          attemptError = error;\n          await driver.sleep(TIME_BETWEEN_ATTEMPTS);\n          continue; // Attempt failed, reattempt\n        }\n        attemptError = null;\n        break; // Attempt succeeded, stop attempting\n       }\n\n       const wasAttemptSuccessful = !attemptError;\n      if (!wasAttemptSuccessful) {\n        throw attemptError;\n       }\n      }",
        "probeMode": "AUTO",
        "pathTraceMode": "inSession",
        "numPathTraces": 3,
        "credentials": [
          "MS365_email",
          "MS365_password"
        ],
        "groups": [
          "Office Online"
        ],
        "sslVersion": "Auto"
      },
      {
        "agents": "$formAgents",
        "enabled": 1,
        "testName": "Microsoft 365 Login",
        "type": "web-transactions",
        "interval": "$formTestInterval",
        "subinterval": "$formTestInterval",
        "url": "https://login.microsoftonline.com",
        "protocol": "TCP",
        "networkMeasurements": 1,
        "mtuMeasurements": 1,
        "bandwidthMeasurements": 0,
        "bgpMeasurements": 1,
        "usePublicBgp": 1,
        "alertsEnabled": 1,
        "alertRules": [
          "Microsoft Online Login Transaction Alert Rule",
          "MS365 BGP Alert Rule",
          "MS365 HTTP Server Alert Rule",
          "MS365 Jitter",
          "MS365 Latency",
          "MS365 Packet Loss"
        ],
        "timeLimit": 20,
        "targetTime": 15,
        "httpTimeLimit": 5,
        "httpTargetTime": 1000,
        "httpVersion": 2,
        "followRedirects": 0,
        "includeHeaders": 1,
        "sslVersionId": 0,
        "verifyCertificate": 1,
        "useNtlm": 0,
        "authType": "NONE",
        "contentRegex": "",
        "transactionScript": "import { By, Key, until } from 'selenium-webdriver';\nimport { driver, credentials, markers, test } from 'thousandeyes';\n\n\nrunScript();\n\nlet email = credentials.get('MS365_email'); // '<<email>>';\nlet password = credentials.get('MS365_password'); // '<<credentialsName>>';\n\n\nasync function runScript() {\n  await configureDriver();\n  await configureDriver();\n let testSettings = test.getSettings();\n\n\n await driver.takeScreenshot();\n\n\n markers.start('Login');\n  await driver.get(testSettings.url);\n\n  await typeText(email, By.id(`i0116`));\n\n  await click(By.id(`idSIButton9`));\n  await driver.wait(until.elementIsVisible(driver.findElement(By.xpath(`//*[@id=\"loginHeader\"]//*[text()=\"Enter password\"]`))))\n\n await typeText(password, By.id(`i0118`));\n\n  await click(By.id(`idSIButton9`));\n\n  await click(By.id(`idBtn_Back`));\n\n markers.stop('Login');\n}\n\nasync function clickText(text) {\n await click(By.xpath(`//*[text()=\"${text}\"]`));\n}\n\n async function configureDriver() {\n  await driver.manage().window().setRect({\n    width:1200,\n     height: 1049 });\n\n     await driver.manage().setTimeouts({\n       implicit: 7 * 1000 // If an element is not found, reattempt for this many milliseconds\n});\n}\n\n\n\n  async function typeText(value, selector) {\n     await simulateHumanDelay();\n     const element = await driver.findElement(selector);\n     await element.clear();\n     await element.sendKeys(value);\n}\n\n    async function simulateHumanDelay() {\n     await driver.sleep(550);\n}\n\n     async function click(selector) {\n      await simulateHumanDelay();\n\n      const configuredTimeouts = await driver.manage().getTimeouts();\n       const clickAttemptEndTime = Date.now() + configuredTimeouts.implicit;\n\n      await reattemptUntil(attemptToClick, clickAttemptEndTime);\n\n      async function attemptToClick() {\n       await driver.findElement(selector).\n       click();\n    }\n   }\n\n    async function reattemptUntil(attemptActionFn, attemptEndTime) {\n      const TIME_BETWEEN_ATTEMPTS = 100;\n      let numberOfAttempts = 0;\n      let attemptError;\n      while (Date.now() < attemptEndTime || numberOfAttempts === 0) {\n        try {\n          numberOfAttempts += 1;\n          await attemptActionFn();\n        }\n        catch (error) {\n          attemptError = error;\n          await driver.sleep(TIME_BETWEEN_ATTEMPTS);\n          continue; // Attempt failed, reattempt\n        }\n        attemptError = null;\n        break; // Attempt succeeded, stop attempting\n       }\n\n       const wasAttemptSuccessful = !attemptError;\n      if (!wasAttemptSuccessful) {\n        throw attemptError;\n       }\n      }",
        "probeMode": "AUTO",
        "pathTraceMode": "inSession",
        "numPathTraces": 3,
        "credentials": [
          "MS365_email",
          "MS365_password"
        ],
        "groups": [
          "Microsoft 365 Online"
        ],
        "sslVersion": "Auto"
      },
      {
        "agents": "$formAgents",
        "enabled": 1,
        "testName": "OneDrive - File Download",
        "type": "web-transactions",
        "interval": "$formTestInterval",
        "subinterval": "$formTestInterval",
        "url": "https://$formMicrosoftTenant-my.sharepoint.com",
        "protocol": "TCP",
        "networkMeasurements": 1,
        "mtuMeasurements": 1,
        "bandwidthMeasurements": 0,
        "bgpMeasurements": 1,
        "usePublicBgp": 1,
        "alertsEnabled": 1,
        "alertRules": [
          "MS365 BGP Alert Rule",
          "MS365 HTTP Server Alert Rule",
          "MS365 Jitter",
          "MS365 Latency",
          "MS365 Packet Loss",
          "OneDrive File Download Transaction Alert Rule"
        ],
        "timeLimit": 25,
        "targetTime": 20,
        "httpTimeLimit": 5,
        "httpTargetTime": 2000,
        "httpVersion": 2,
        "followRedirects": 0,
        "includeHeaders": 1,
        "sslVersionId": 0,
        "verifyCertificate": 1,
        "useNtlm": 0,
        "authType": "NONE",
        "contentRegex": "",
        "transactionScript": "import { By, Key } from 'selenium-webdriver';\nimport { driver, markers, credentials, downloads, test } from 'thousandeyes';\n\n\nrunScript();\n\nlet email = credentials.get('MS365_email'); // '<<email>>';\nlet password = credentials.get('MS365_password'); // '<<password>>';\nlet filename = credentials.get('MS365_filename'); //'<<filename>>';\nasync function runScript() {\n\n  await configureDriver();\n\nawait configureDriver();\n let testSettings = test.getSettings();\n  markers.start('Page Load');\n\n  await driver.get(testSettings.url);\n\n  markers.stop('Page Load');\n  markers.start('Login');\n\n  // Click on 'Enter your email, phone, or Skype.'\n  await click(By.id(`i0116`));\n\n  await typeText(email, By.id(`i0116`));\n\n  // Click on 'Next'\n  await click(By.id(`idSIButton9`));\n\n   await click(By.id(`i0118`));\n\n  await typeText(password, By.id(`i0118`));\n\n  // Click on 'Sign in'\n  await click(By.id(`idSIButton9`));\n\n  markers.stop('Login');\n  markers.start('Backend');\n  // Click on 'No'\n  await click(By.id(`idBtn_Back`));\n  markers.stop('Backend');\n\n  await driver.takeScreenshot();\n\n  // Click on 'Download'\n  markers.start('Download');\n  await clickText (filename);\n  //await click(By.css('[data-icon-name=\"Download\"]'));\n  await click(By.css('[aria-label=\"Download\"]'));\n  //await click(By.id(`id_151`));\n  await downloads.waitForDownload(filename, 60000);\n  markers.stop('Download');\n  \n\n}\n \nasync function findElementWithText(text) {\n return await driver.findElement(By.xpath(`//*[text()=\"${text}\"]`));\n}\n \nasync function clickText(text) {\n await click(By.xpath(`//*[text()=\"${text}\"]`));\n}\n \nasync function markerClick(selector, markerStop, markerStart) {\n await driver.findElement(selector);\n await markers.stop(markerStop);\n await markers.start(markerStart);\n await click(selector);\n}\n\n\n\nasync function configureDriver() {\n  await driver.manage().window().setRect({\n    width: 1200,\n    height: 758 });\n\n  await driver.manage().setTimeouts({\n    implicit: 7 * 1000 // If an element is not found, reattempt for this many milliseconds\n  });\n}\n\n\n\nasync function click(selector) {\n  await simulateHumanDelay();\n\n  const configuredTimeouts = await driver.manage().getTimeouts();\n  const clickAttemptEndTime = Date.now() + configuredTimeouts.implicit;\n\n  await reattemptUntil(attemptToClick, clickAttemptEndTime);\n\n  async function attemptToClick() {\n    await driver.findElement(selector).\n    click();\n  }\n}\n\nasync function reattemptUntil(attemptActionFn, attemptEndTime) {\n  const TIME_BETWEEN_ATTEMPTS = 100;\n  let numberOfAttempts = 0;\n  let attemptError;\n  while (Date.now() < attemptEndTime || numberOfAttempts === 0) {\n    try {\n      numberOfAttempts += 1;\n      await attemptActionFn();\n    }\n    catch (error) {\n      attemptError = error;\n      await driver.sleep(TIME_BETWEEN_ATTEMPTS);\n      continue; // Attempt failed, reattempt\n    }\n    attemptError = null;\n    break; // Attempt succeeded, stop attempting\n  }\n\n  const wasAttemptSuccessful = !attemptError;\n  if (!wasAttemptSuccessful) {\n    throw attemptError;\n  }\n}\n\nasync function simulateHumanDelay() {\n  await driver.sleep(550);\n}\n\nasync function typeText(value, selector) {\n  await simulateHumanDelay();\n  const element = await driver.findElement(selector);\n  await element.clear();\n  await element.sendKeys(value);\n}",
        "userAgent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36",
        "probeMode": "AUTO",
        "pathTraceMode": "inSession",
        "numPathTraces": 3,
        "credentials": [
          "MS365_email",
          "MS365_password",
          "MS365_filename"
        ],
        "groups": [
          "OneDrive Online"
        ],
        "sslVersion": "Auto"
      },
      {
        "agents": "$formAgents",
        "enabled": 1,
        "testName": "OneNote Login",
        "type": "web-transactions",
        "interval": "$formTestInterval",
        "subinterval": "$formTestInterval",
        "url": "https://www.onenote.com/hrd",
        "protocol": "TCP",
        "networkMeasurements": 1,
        "mtuMeasurements": 1,
        "bandwidthMeasurements": 0,
        "bgpMeasurements": 1,
        "usePublicBgp": 1,
        "alertsEnabled": 1,
        "alertRules": [
          "MS365 BGP Alert Rule",
          "MS365 HTTP Server Alert Rule",
          "MS365 Jitter",
          "MS365 Latency",
          "MS365 Packet Loss",
          "OneNote Application Login Transaction Alert Rule"
        ],
        "timeLimit": 30,
        "targetTime": 20,
        "httpTimeLimit": 5,
        "httpTargetTime": 1000,
        "httpVersion": 2,
        "followRedirects": 0,
        "includeHeaders": 1,
        "sslVersionId": 0,
        "verifyCertificate": 1,
        "useNtlm": 0,
        "authType": "NONE",
        "contentRegex": "",
        "transactionScript": "import { By, Key } from 'selenium-webdriver';\nimport { driver, credentials, markers, test } from 'thousandeyes';\n\nrunScript();\n\nlet email = credentials.get('MS365_email'); // '<<email>>';\nlet password = credentials.get('MS365_password'); // '<<credentialsName>>';\n\nasync function runScript() {\n    markers.start('Load');\n    await configureDriver();\n   await configureDriver();\n  let testSettings = test.getSettings();\n  await driver.get(testSettings.url);\n   // await driver.wait(until.titleContains('Sign in'), 5000);\n\n    await driver.takeScreenshot();\n    markers.stop('Load');\n\n    // Login\n    markers.start('Login');\n    await driver.switchTo().frame(driver.findElement(By.id(`h_signiniframe`)))\n    await click(By.css(`[placeholder=\"Email, phone, or Skype\"]`));\n    await typeText(email, By.css(`[placeholder=\"Email, phone, or Skype\"]`));\n\n    // Click on 'Next'\n\tawait click(By.css(`[value=\"Next\"]`));\n\n    await driver.switchTo().defaultContent()\n\n    // Click on 'Enter the password for tonystark@ac...'\n\tawait click(By.id(`i0118`));\n\n    await typeText(password, By.id(`i0118`));\n\n    // Click on 'Sign in'\n\tawait click(By.id(`idSIButton9`));\n    markers.stop('Login');\n    \n    // Click on 'No'\n\tawait click(By.id(`idBtn_Back`));\n    \n}\n\nasync function configureDriver() {\n    await driver.manage().window().setRect({ \n        width: 1200, \n        height: 1048\n    });\n    await driver.manage().setTimeouts({\n        implicit: 7 * 1000, // If an element is not found, reattempt for this many milliseconds\n    });\n}\n\n\n\nasync function click(selector) {\n    await simulateHumanDelay();\n\n    const configuredTimeouts = await driver.manage().getTimeouts();\n    const clickAttemptEndTime = Date.now() + configuredTimeouts.implicit;\n\n    await reattemptUntil(attemptToClick, clickAttemptEndTime);\n    \n    async function attemptToClick() {\n        await driver.findElement(selector)\n                    .click();\n    }\n}\n\nasync function reattemptUntil(attemptActionFn, attemptEndTime) {\n    const TIME_BETWEEN_ATTEMPTS = 100;\n    let numberOfAttempts = 0;\n    let attemptError;\n    while (Date.now() < attemptEndTime || numberOfAttempts === 0) {\n        try {\n            numberOfAttempts += 1;\n            await attemptActionFn();\n        }\n        catch (error) {\n            attemptError = error;\n            await driver.sleep(TIME_BETWEEN_ATTEMPTS);\n            continue; // Attempt failed, reattempt\n        }\n        attemptError = null;\n        break; // Attempt succeeded, stop attempting\n    }\n\n    const wasAttemptSuccessful = !attemptError;\n    if (!wasAttemptSuccessful) {\n        throw attemptError;\n    }\n}\n\nasync function simulateHumanDelay() {\n    await driver.sleep(550);\n}\n\nasync function typeText(value, selector) {\n    await simulateHumanDelay();\n    const element = await driver.findElement(selector);\n    await element.clear();\n    await element.sendKeys(value);\n}\n",
        "probeMode": "AUTO",
        "pathTraceMode": "inSession",
        "numPathTraces": 3,
        "credentials": [
          "MS365_email",
          "MS365_password"
        ],
        "groups": [
          "OneNote Online"
        ],
        "sslVersion": "Auto"
      },
      {
        "agents": "$formAgents",
        "enabled": 1,
        "testName": "Outlook - Send Mail",
        "type": "web-transactions",
        "interval": "$formTestInterval",
        "subinterval": "$formTestInterval",
        "url": "https://outlook.office365.com/",
        "protocol": "TCP",
        "networkMeasurements": 1,
        "mtuMeasurements": 1,
        "bandwidthMeasurements": 0,
        "bgpMeasurements": 1,
        "usePublicBgp": 1,
        "alertsEnabled": 1,
        "alertRules": [
          "MS365 BGP Alert Rule",
          "MS365 HTTP Server Alert Rule",
          "MS365 Jitter",
          "MS365 Latency",
          "MS365 Packet Loss",
          "Outlook Send Mail Transaction Alert Rule"
        ],
        "timeLimit": 50,
        "targetTime": 40,
        "httpTimeLimit": 5,
        "httpTargetTime": 2000,
        "httpVersion": 2,
        "followRedirects": 0,
        "includeHeaders": 1,
        "sslVersionId": 0,
        "verifyCertificate": 1,
        "useNtlm": 0,
        "authType": "NONE",
        "contentRegex": "",
        "transactionScript": "import { By, Key, Browser, until } from 'selenium-webdriver';\nimport { driver, credentials, markers, test } from 'thousandeyes';\n\nlet email = credentials.get('MS365_email'); // '<<email>>';\nlet password = credentials.get('MS365_password'); // '<<credentialsName>>';\nlet sendToEmail = credentials.get('MS365_recipient'); // '<<recipientsEmail>>';\n\nrunScript();\n\nasync function runScript() {\n\n  await configureDriver();\n\n  await configureDriver();\n let testSettings = test.getSettings();\n  markers.start('Page Load');\n  await driver.get(testSettings.url);\n  markers.stop('Page Load');\n\n  markers.start('Login');\n  await typeText(email, By.id(`i0116`));\n  await click(By.id(`idSIButton9`));\n  await driver.wait(until.elementIsVisible(driver.findElement(By.xpath(`//*[@id=\"loginHeader\"]//*[text()=\"Enter password\"]`))))\n  await click(By.id(`i0118`));\n  await typeText(password, By.id(`i0118`));\n  await click(By.id(`idSIButton9`));\n\n  // Click on 'No'\n  await markerClick(By.id('idBtn_Back'), \"Login\", \"Compose Email\");\n\n  // Click on 'New message'\n  await click(By.id(`id__6`));\n  await typeText(email, By.css(`[aria-label=\"To\"]`));\n  await typeText('\\n', By.css(`[aria-label=\"To\"]`));\n\n  // Click on 'Add a subject'\n  await click(By.css(`[aria-label=\"Add a subject\"]`));\n\n  let subject = \"Hello \" + Date.now();\n  await typeText(subject, By.css(`[aria-label=\"Add a subject\"]`));\n  await console.log(\"Sent: \" + subject);\n\n  // Click on 'Send'\n  await markerClick(By.css(`[aria-label=\"Send\"]`), \"Compose Email\", \"Email Round Trip\");\n\n  //await driver.navigate().refresh();\n  await driver.sleep(5000);\n  await click(By.xpath(`//div[@title=\"Drafts\"]`));\n\n  await driver.takeScreenshot();\n  await click(By.xpath(`//div[@title=\"Inbox\"]`));\n\n  await driver.takeScreenshot();\n\n  await findElementWithText(subject);\n  markers.stop('Email Round Trip');\n  await console.log(\"Found email inbox: \" + subject);\n\n  await driver.takeScreenshot();\n\n}\n\nasync function findElementWithText(text) {\n  return await driver.findElement(By.xpath(`//*[text()=\"${text}\"]`));\n}\n\nasync function clickText(text) {\n  await click(By.xpath(`//*[text()=\"${text}\"]`));\n}\n\nasync function markerClick(selector, markerStop, markerStart) {\n  await driver.findElement(selector);\n  await markers.stop(markerStop);\n  await markers.start(markerStart);\n  await click(selector);\n}\n\nasync function configureDriver() {\n  await driver.manage().window().setRect({\n    width: 1572,\n    height: 1133 });\n\n\n  await driver.manage().setTimeouts({\n    implicit: 12 * 1000 // If an element is not found, reattempt for this many milliseconds\n  });\n}\n\nasync function typeText(value, selector) {\n  await simulateHumanDelay();\n  const element = await driver.findElement(selector);\n  await element.clear();\n  await element.sendKeys(value);\n}\n\nasync function simulateHumanDelay() {\n  await driver.sleep(550);\n}\n\nasync function click(selector) {\n  await simulateHumanDelay();\n\n  const configuredTimeouts = await driver.manage().getTimeouts();\n  const clickAttemptEndTime = Date.now() + configuredTimeouts.implicit;\n\n  await reattemptUntil(attemptToClick, clickAttemptEndTime);\n\n  async function attemptToClick() {\n    await driver.findElement(selector).click();\n  }\n}\n\nasync function reattemptUntil(attemptActionFn, attemptEndTime) {\n  const TIME_BETWEEN_ATTEMPTS = 100;\n  let numberOfAttempts = 0;\n  let attemptError;\n  while (Date.now() < attemptEndTime || numberOfAttempts === 0) {\n    try {\n      numberOfAttempts += 1;\n      await attemptActionFn();\n    }\n    catch (error) {\n      attemptError = error;\n      await driver.sleep(TIME_BETWEEN_ATTEMPTS);\n      continue; // Attempt failed, reattempt\n    }\n    attemptError = null;\n    break; // Attempt succeeded, stop attempting\n  }\n\n  const wasAttemptSuccessful = !attemptError;\n  if (!wasAttemptSuccessful) {\n    throw attemptError;\n  }\n}",
        "userAgent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.84 Safari/537.36",
        "probeMode": "AUTO",
        "pathTraceMode": "inSession",
        "numPathTraces": 3,
        "credentials": [
          "MS365_email",
          "MS365_password",
          "MS365_recipient"
        ],
        "groups": [
          "Outlook Online"
        ],
        "sslVersion": "Auto"
      },
      {
        "agents": "$formAgents",
        "enabled": 1,
        "testName": "Sharepoint - File Download",
        "type": "web-transactions",
        "interval": "$formTestInterval",
        "subinterval": "$formTestInterval",
        "url": "https://$formMicrosoftTenant.sharepoint.com",
        "protocol": "TCP",
        "networkMeasurements": 1,
        "mtuMeasurements": 1,
        "bandwidthMeasurements": 0,
        "bgpMeasurements": 1,
        "usePublicBgp": 1,
        "alertsEnabled": 1,
        "alertRules": [
          "MS365 BGP Alert Rule",
          "MS365 HTTP Server Alert Rule",
          "MS365 Jitter",
          "MS365 Latency",
          "MS365 Packet Loss",
          "Sharepoint File Download Transaction Alert Rule"
        ],
        "timeLimit": 35,
        "targetTime": 30,
        "httpTimeLimit": 5,
        "httpTargetTime": 1000,
        "httpVersion": 2,
        "followRedirects": 1,
        "includeHeaders": 1,
        "sslVersionId": 0,
        "verifyCertificate": 1,
        "useNtlm": 0,
        "authType": "NONE",
        "contentRegex": "",
        "transactionScript": "import { By, Key, Browser, until } from 'selenium-webdriver';\nimport { driver, markers, credentials, downloads, test } from 'thousandeyes';\n\nlet email = credentials.get('MS365_email');\nlet password = credentials.get('MS365_password');\nlet filename = credentials.get('MS365_filename');\n\nrunScript();\n\nasync function runScript()\n\n{\n\n  await configureDriver();\n\n  await configureDriver();\n  let testSettings = test.getSettings();\n\n\n  markers.start('Login');\n  await driver.get(testSettings.url + '/Shared%20Documents/Forms/AllItems.aspx');\n\n  await typeText(email, By.id(`i0116`));\n\n  // Click on 'Next'\n  await click(By.id(`idSIButton9`));\n  await driver.wait(until.elementIsVisible(driver.findElement(By.xpath(`//*[@id=\"loginHeader\"]//*[text()=\"Enter password\"]`))))\n\n  await typeText(password, By.id(`i0118`));\n\n  // Click on 'Sign in'\n  await click(By.id(`idSIButton9`));\n\n  // Click on 'No'\n  await click(By.id(`idBtn_Back`));\n\n  markers.stop('Login');\n\n  // Click on 'Download'\n  await click(By.xpath(`//button[text()=\"${filename}\"]`));\n  await driver.takeScreenshot();\n  markers.start('Download');\n  await click(By.css('[data-icon-name=\"Download\"]'));\n  await downloads.waitForDownload(filename, 20000);\n  markers.stop('Download');\n\n}\n\nasync function clickText(text) {\n  await click(By.xpath(`//*[text()=\"${text}\"]`));\n}\n\nasync function configureDriver() {\n  await driver.manage().window().setRect({\n    width: 1200,\n    height: 1049 });\n\n  await driver.manage().setTimeouts({\n    implicit: 7 * 1000 // If an element is not found, reattempt for this many milliseconds\n  });\n}\n\n\n\nasync function typeText(value, selector) {\n  await simulateHumanDelay();\n  const element = await driver.findElement(selector);\n  await element.clear();\n  await element.sendKeys(value);\n}\n\nasync function simulateHumanDelay() {\n  await driver.sleep(550);\n}\n\nasync function click(selector) {\n  await simulateHumanDelay();\n\n  const configuredTimeouts = await driver.manage().getTimeouts();\n  const clickAttemptEndTime = Date.now() + configuredTimeouts.implicit;\n\n  await reattemptUntil(attemptToClick, clickAttemptEndTime);\n\n  async function attemptToClick() {\n    await driver.findElement(selector).\n    click();\n  }\n}\n\nasync function reattemptUntil(attemptActionFn, attemptEndTime) {\n  const TIME_BETWEEN_ATTEMPTS = 100;\n  let numberOfAttempts = 0;\n  let attemptError;\n  while (Date.now() < attemptEndTime || numberOfAttempts === 0) {\n    try {\n      numberOfAttempts += 1;\n      await attemptActionFn();\n    }\n    catch (error) {\n      attemptError = error;\n      await driver.sleep(TIME_BETWEEN_ATTEMPTS);\n      continue; // Attempt failed, reattempt\n    }\n    attemptError = null;\n    break; // Attempt succeeded, stop attempting\n  }\n\n  const wasAttemptSuccessful = !attemptError;\n  if (!wasAttemptSuccessful) {\n    throw attemptError;\n  }\n}",
        "userAgent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.84 Safari/537.36",
        "probeMode": "AUTO",
        "pathTraceMode": "inSession",
        "numPathTraces": 3,
        "credentials": [
          "MS365_email",
          "MS365_password",
          "MS365_filename"
        ],
        "groups": [
          "Sharepoint Online"
        ],
        "sslVersion": "Auto"
      }
    ],
    "reports": [
      {
        "title": "Microsoft 365 Global Status",
        "isDefaultForAccount": true,
        "widgets": [
          {
            "type": "Number",
            "title": "Microsoft 365 Global Status - past 24 hours",
            "visualMode": "Full",
            "numberCards": [
              {
                "description": "Microsoft Online Login",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 100.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Availability",
                "filters": {
                  "Test Labels": [
                    "Microsoft 365 Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Office 365 Applications",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 100.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Availability",
                "filters": {
                  "Test Labels": [
                    "Office Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "OneDrive",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 30.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Availability",
                "filters": {
                  "Test Labels": [
                    "OneDrive Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Sharepoint",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 100.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Availability",
                "filters": {
                  "Test Labels": [
                    "Sharepoint Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Outlook",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 100.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Availability",
                "filters": {
                  "Test Labels": [
                    "Outlook Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "OneNote",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 100.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Availability",
                "filters": {
                  "Test Labels": [
                    "OneNote Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              }
            ]
          },
          {
            "type": "Number",
            "title": "Baseline of Microsoft 365 Transactions - past 14 days",
            "visualMode": "Full",
            "numberCards": [
              {
                "description": "Microsoft Online Login",
                "measure": {
                  "type": "nth Percentile",
                  "percentileValue": 98.0
                },
                "compareToPreviousValue": false,
                "fixedTimespan": {
                  "value": 14,
                  "unit": "Days"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - Transactions",
                "metric": "Transaction Time",
                "filters": {
                  "Test Labels": [
                    "Microsoft 365 Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Sharepoint",
                "measure": {
                  "type": "nth Percentile",
                  "percentileValue": 98.0
                },
                "compareToPreviousValue": false,
                "fixedTimespan": {
                  "value": 14,
                  "unit": "Days"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - Transactions",
                "metric": "Transaction Time",
                "filters": {
                  "Test Labels": [
                    "Sharepoint Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Outlook",
                "measure": {
                  "type": "nth Percentile",
                  "percentileValue": 98.0
                },
                "compareToPreviousValue": false,
                "fixedTimespan": {
                  "value": 14,
                  "unit": "Days"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - Transactions",
                "metric": "Transaction Time",
                "filters": {
                  "Test Labels": [
                    "Outlook Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "OneDrive",
                "measure": {
                  "type": "nth Percentile",
                  "percentileValue": 98.0
                },
                "compareToPreviousValue": false,
                "fixedTimespan": {
                  "value": 14,
                  "unit": "Days"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - Transactions",
                "metric": "Transaction Time",
                "filters": {
                  "Test Labels": [
                    "OneDrive Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Office 365 Applications",
                "measure": {
                  "type": "nth Percentile",
                  "percentileValue": 98.0
                },
                "compareToPreviousValue": false,
                "fixedTimespan": {
                  "value": 14,
                  "unit": "Days"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - Transactions",
                "metric": "Transaction Time",
                "filters": {
                  "Test Labels": [
                    "Office Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "OneNote",
                "measure": {
                  "type": "nth Percentile",
                  "percentileValue": 98.0
                },
                "compareToPreviousValue": false,
                "fixedTimespan": {
                  "value": 14,
                  "unit": "Days"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - Transactions",
                "metric": "Transaction Time",
                "filters": {
                  "Test Labels": [
                    "OneNote Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "DNS Resolution to MS",
                "measure": {
                  "type": "nth Percentile",
                  "percentileValue": 98.0
                },
                "compareToPreviousValue": false,
                "fixedTimespan": {
                  "value": 14,
                  "unit": "Days"
                },
                "dataSource": "CLOUD_AND_ENTERPRISE_AGENTS",
                "metricGroup": "DOMAIN_TRACE",
                "metric": "DNS_TRACE_QUERY_TIME",
                "filters": {
                  "Test Labels": [
                    "DNS Resolution to Microsoft Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              }
            ]
          },
          {
            "type": "Number",
            "title": "Microsoft Online Status - past 24 hours",
            "visualMode": "Half screen",
            "numberCards": [
              {
                "description": "Microsoft Online Latency",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 100.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Network - Agent to Server",
                "metric": "Latency",
                "filters": {
                  "Test Labels": [
                    "Microsoft 365 Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Microsoft Online Packet Loss",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 1.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Network - Agent to Server",
                "metric": "Packet Loss",
                "filters": {
                  "Test Labels": [
                    "Microsoft 365 Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Microsoft Online Jitter",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 30.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Network - Agent to Server",
                "metric": "Jitter",
                "filters": {
                  "Test Labels": [
                    "Microsoft 365 Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Microsoft Online Total Transaction Time",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 15000.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - Transactions",
                "metric": "Transaction Time",
                "filters": {
                  "Test Labels": [
                    "Microsoft 365 Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Microsoft Online Server Response Time",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 300.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Response Time",
                "filters": {
                  "Test Labels": [
                    "Microsoft 365 Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              }
            ]
          },
          {
            "type": "Number",
            "title": "Sharepoint Status - past 24 hours",
            "visualMode": "Half screen",
            "numberCards": [
              {
                "description": "Sharepoint Latency",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 100.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Network - Agent to Server",
                "metric": "Latency",
                "filters": {
                  "Test Labels": [
                    "Sharepoint Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Sharepoint Packet Loss",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 1.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Network - Agent to Server",
                "metric": "Packet Loss",
                "filters": {
                  "Test Labels": [
                    "Sharepoint Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Sharepoint Jitter",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 30.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Network - Agent to Server",
                "metric": "Jitter",
                "filters": {
                  "Test Labels": [
                    "Sharepoint Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "SharePoint Total Transaction Time",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 36000.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - Transactions",
                "metric": "Transaction Time",
                "filters": {
                  "Test Labels": [
                    "Sharepoint Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Sharepoint Response Time",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 500.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Response Time",
                "filters": {
                  "Test Labels": [
                    "Sharepoint Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              }
            ]
          },
          {
            "type": "Number",
            "title": "Outlook Status - past 24 hours",
            "visualMode": "Half screen",
            "numberCards": [
              {
                "description": "Outlook Latency",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 100.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Network - Agent to Server",
                "metric": "Latency",
                "filters": {
                  "Test Labels": [
                    "Outlook Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Outlook Packet Loss",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 1.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Network - Agent to Server",
                "metric": "Packet Loss",
                "filters": {
                  "Test Labels": [
                    "Outlook Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Outlook Jitter",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 30.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Network - Agent to Server",
                "metric": "Jitter",
                "filters": {
                  "Test Labels": [
                    "Outlook Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Outlook Total Transaction Time",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 36000.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - Transactions",
                "metric": "Transaction Time",
                "filters": {
                  "Test Labels": [
                    "Outlook Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Outlook Response Time",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 500.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Response Time",
                "filters": {
                  "Test Labels": [
                    "Outlook Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              }
            ]
          },
          {
            "type": "Number",
            "title": "OneDrive Status - past 24 hours",
            "visualMode": "Half screen",
            "numberCards": [
              {
                "description": "OneDrive Latency",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 100.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Network - Agent to Server",
                "metric": "Latency",
                "filters": {
                  "Test Labels": [
                    "OneDrive Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "OneDrive Packet Loss",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 1.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Network - Agent to Server",
                "metric": "Packet Loss",
                "filters": {
                  "Test Labels": [
                    "OneDrive Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "OneDrive Jitter",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 30.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Network - Agent to Server",
                "metric": "Jitter",
                "filters": {
                  "Test Labels": [
                    "OneDrive Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "OneDrive Total Transaction Time",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 36000.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - Transactions",
                "metric": "Transaction Time",
                "filters": {
                  "Test Labels": [
                    "OneDrive Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "OneDrive Response Time",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 500.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Response Time",
                "filters": {
                  "Test Labels": [
                    "OneDrive Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              }
            ]
          },
          {
            "type": "Number",
            "title": "Office Apps - past 24 hours",
            "visualMode": "Half screen",
            "numberCards": [
              {
                "description": "Office Apps Latency",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 100.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Network - Agent to Server",
                "metric": "Latency",
                "filters": {
                  "Test Labels": [
                    "Office Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Office Apps Packet Loss",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 1.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Network - Agent to Server",
                "metric": "Packet Loss",
                "filters": {
                  "Test Labels": [
                    "Office Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Office Apps Jitter",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 30.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Network - Agent to Server",
                "metric": "Jitter",
                "filters": {
                  "Test Labels": [
                    "Office Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Office Apps Total Transaction Time",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 36000.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - Transactions",
                "metric": "Transaction Time",
                "filters": {
                  "Test Labels": [
                    "Office Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "Office Apps Response Time",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 500.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Response Time",
                "filters": {
                  "Test Labels": [
                    "Office Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              }
            ]
          },
          {
            "type": "Number",
            "title": "OneNote Status - past 24 hours",
            "visualMode": "Half screen",
            "numberCards": [
              {
                "description": "OneNote Latency",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 100.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Network - Agent to Server",
                "metric": "Latency",
                "filters": {
                  "Test Labels": [
                    "OneNote Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "OneNote Packet Loss",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 1.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Network - Agent to Server",
                "metric": "Packet Loss",
                "filters": {
                  "Test Labels": [
                    "OneNote Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "OneNote Jitter",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 30.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Network - Agent to Server",
                "metric": "Jitter",
                "filters": {
                  "Test Labels": [
                    "OneNote Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "OneNote Page Load Time",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 20000.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - Transactions",
                "metric": "Transaction Time",
                "filters": {
                  "Test Labels": [
                    "OneNote Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              },
              {
                "description": "OneNote Response Time",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 500.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Response Time",
                "filters": {
                  "Test Labels": [
                    "OneNote Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              }
            ]
          },
          {
            "type": "Number",
            "title": "DNS Server Resolution to Microsoft Online - past 24 hours",
            "visualMode": "Full",
            "numberCards": [
              {
                "description": "DNS Server Resolution Time",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "maxScale": 150.0,
                "dataSource": "CLOUD_AND_ENTERPRISE_AGENTS",
                "metricGroup": "DOMAIN_TRACE",
                "metric": "DNS_TRACE_QUERY_TIME",
                "filters": {
                  "Test Labels": [
                    "DNS Resolution to Microsoft Online"
                  ],
                  "Agent Labels": [
                    "Branch"
                  ]
                }
              }
            ]
          },
          {
            "type": "Map",
            "title": "Microsoft Online Login - Mean Response Time per Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Web - HTTP Server",
            "metric": "Response Time",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "Microsoft 365 Online"
              ],
              "Agent Labels": [
                "Branch"
              ]
            },
            "fixedTimespan": {
              "value": 1,
              "unit": "Days"
            },
            "groupBy": "Agents",
            "maxScale": 500.0,
            "sortBy": "Value",
            "sortDirection": "Descending"
          },
          {
            "type": "Map",
            "title": "Outlook - Mean Response Time per Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Web - HTTP Server",
            "metric": "Response Time",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "Outlook Online"
              ],
              "Agent Labels": [
                "Branch"
              ]
            },
            "fixedTimespan": {
              "value": 1,
              "unit": "Days"
            },
            "groupBy": "Agents",
            "maxScale": 500.0,
            "sortBy": "Value",
            "sortDirection": "Ascending"
          },
          {
            "type": "Time Series: Line",
            "title": "Microsoft Online - Jitter by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Network - Agent to Server",
            "metric": "Jitter",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "Microsoft 365 Online"
              ]
            },
            "showTimeseriesOverallBaseline": false,
            "groupBy": "Agents",
            "isTimeseriesOneChartPerLine": false,
            "maxScale": 30.0
          },
          {
            "type": "Time Series: Line",
            "title": "Outlook - Jitter by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Network - Agent to Server",
            "metric": "Jitter",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "Outlook Online"
              ]
            },
            "showTimeseriesOverallBaseline": false,
            "groupBy": "Agents",
            "isTimeseriesOneChartPerLine": false,
            "maxScale": 30.0
          },
          {
            "type": "Time Series: Line",
            "title": "Microsoft Online - Latency by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Network - Agent to Server",
            "metric": "Latency",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "Microsoft 365 Online"
              ]
            },
            "showTimeseriesOverallBaseline": false,
            "groupBy": "Agents",
            "isTimeseriesOneChartPerLine": false,
            "maxScale": 200.0
          },
          {
            "type": "Time Series: Line",
            "title": "Outlook - Latency by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Network - Agent to Server",
            "metric": "Latency",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "Outlook Online"
              ]
            },
            "showTimeseriesOverallBaseline": false,
            "groupBy": "Agents",
            "isTimeseriesOneChartPerLine": false,
            "maxScale": 200.0
          },
          {
            "type": "Time Series: Line",
            "title": "Microsoft Online - Packet Loss by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Network - Agent to Server",
            "metric": "Packet Loss",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "Microsoft 365 Online"
              ]
            },
            "showTimeseriesOverallBaseline": false,
            "groupBy": "Agents",
            "isTimeseriesOneChartPerLine": false,
            "maxScale": 2.0
          },
          {
            "type": "Time Series: Line",
            "title": "Outlook - Packet Loss by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Network - Agent to Server",
            "metric": "Packet Loss",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "Outlook Online"
              ]
            },
            "showTimeseriesOverallBaseline": false,
            "groupBy": "Agents",
            "isTimeseriesOneChartPerLine": false,
            "maxScale": 2.0
          },
          {
            "type": "Map",
            "title": "Sharepoint - Response Time by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Web - HTTP Server",
            "metric": "Response Time",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "Sharepoint Online"
              ],
              "Agent Labels": [
                "Branch"
              ]
            },
            "groupBy": "Agents",
            "maxScale": 500.0,
            "sortBy": "Value",
            "sortDirection": "Ascending"
          },
          {
            "type": "Map",
            "title": "Office Apps - Response Time by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Web - HTTP Server",
            "metric": "Response Time",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "Sharepoint Online"
              ],
              "Agent Labels": [
                "Branch"
              ]
            },
            "groupBy": "Agents",
            "maxScale": 500.0,
            "sortBy": "Value",
            "sortDirection": "Ascending"
          },
          {
            "type": "Time Series: Line",
            "title": "Sharepoint - Jitter by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Network - Agent to Server",
            "metric": "Jitter",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "Sharepoint Online"
              ]
            },
            "showTimeseriesOverallBaseline": false,
            "groupBy": "Agents",
            "isTimeseriesOneChartPerLine": false,
            "maxScale": 30.0
          },
          {
            "type": "Time Series: Line",
            "title": "Office Apps - Jitter by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Network - Agent to Server",
            "metric": "Jitter",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "Office Online"
              ]
            },
            "showTimeseriesOverallBaseline": false,
            "groupBy": "Agents",
            "isTimeseriesOneChartPerLine": false,
            "maxScale": 30.0
          },
          {
            "type": "Time Series: Line",
            "title": "Sharepoint - Latency by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Network - Agent to Server",
            "metric": "Latency",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "Sharepoint Online"
              ]
            },
            "showTimeseriesOverallBaseline": false,
            "groupBy": "Agents",
            "isTimeseriesOneChartPerLine": false,
            "maxScale": 200.0
          },
          {
            "type": "Time Series: Line",
            "title": "Office Apps - Latency by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Network - Agent to Server",
            "metric": "Latency",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "Office Online"
              ]
            },
            "showTimeseriesOverallBaseline": false,
            "groupBy": "Agents",
            "isTimeseriesOneChartPerLine": false,
            "maxScale": 200.0
          },
          {
            "type": "Time Series: Line",
            "title": "Sharepoint - Packet Loss by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Network - Agent to Server",
            "metric": "Packet Loss",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "Sharepoint Online"
              ]
            },
            "showTimeseriesOverallBaseline": false,
            "groupBy": "Agents",
            "isTimeseriesOneChartPerLine": false,
            "maxScale": 2.0
          },
          {
            "type": "Time Series: Line",
            "title": "Office Apps - Packet Loss by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Network - Agent to Server",
            "metric": "Packet Loss",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "Office Online"
              ]
            },
            "showTimeseriesOverallBaseline": false,
            "groupBy": "Agents",
            "isTimeseriesOneChartPerLine": false,
            "maxScale": 2.0
          },
          {
            "type": "Map",
            "title": "OneDrive - Response Time by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Web - HTTP Server",
            "metric": "Response Time",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "OneDrive Online"
              ],
              "Agent Labels": [
                "Branch"
              ]
            },
            "groupBy": "Agents",
            "maxScale": 500.0,
            "sortBy": "Value",
            "sortDirection": "Ascending"
          },
          {
            "type": "Map",
            "title": "OneNote - Response Time by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Web - HTTP Server",
            "metric": "Response Time",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "OneNote Online"
              ],
              "Agent Labels": [
                "Branch"
              ]
            },
            "groupBy": "Agents",
            "maxScale": 500.0,
            "sortBy": "Value",
            "sortDirection": "Ascending"
          },
          {
            "type": "Time Series: Line",
            "title": "OneDrive - Jitter by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Network - Agent to Server",
            "metric": "Jitter",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "OneDrive Online"
              ]
            },
            "showTimeseriesOverallBaseline": false,
            "groupBy": "Agents",
            "isTimeseriesOneChartPerLine": false,
            "maxScale": 30.0
          },
          {
            "type": "Time Series: Line",
            "title": "OneNote - Jitter by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Network - Agent to Server",
            "metric": "Jitter",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "OneNote Online"
              ]
            },
            "showTimeseriesOverallBaseline": false,
            "groupBy": "Agents",
            "isTimeseriesOneChartPerLine": false,
            "maxScale": 30.0
          },
          {
            "type": "Time Series: Line",
            "title": "OneDrive - Packet Loss by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Network - Agent to Server",
            "metric": "Packet Loss",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "OneDrive Online"
              ]
            },
            "showTimeseriesOverallBaseline": false,
            "groupBy": "Agents",
            "isTimeseriesOneChartPerLine": false,
            "maxScale": 2.0
          },
          {
            "type": "Time Series: Line",
            "title": "OneNote - Packet Loss by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Network - Agent to Server",
            "metric": "Packet Loss",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "OneNote Online"
              ]
            },
            "showTimeseriesOverallBaseline": false,
            "groupBy": "Agents",
            "isTimeseriesOneChartPerLine": false,
            "maxScale": 2.0
          },
          {
            "type": "Time Series: Line",
            "title": "OneDrive - Latency by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Network - Agent to Server",
            "metric": "Latency",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "OneDrive Online"
              ]
            },
            "showTimeseriesOverallBaseline": false,
            "groupBy": "Agents",
            "isTimeseriesOneChartPerLine": false,
            "maxScale": 100.0
          },
          {
            "type": "Time Series: Line",
            "title": "OneNote - Latency by Site",
            "visualMode": "Half screen",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Network - Agent to Server",
            "metric": "Latency",
            "measure": {
              "type": "Mean"
            },
            "filters": {
              "Test Labels": [
                "OneNote Online"
              ]
            },
            "showTimeseriesOverallBaseline": false,
            "groupBy": "Agents",
            "isTimeseriesOneChartPerLine": false,
            "maxScale": 100.0
          }
        ],
        "apiLinks": [
          {
            "rel": "self",
            "href": "https://api.thousandeyes.com/v7/reports/5ec694ff90e5e6358d64c807"
          },
          {
            "rel": "snapshots",
            "href": "https://api.thousandeyes.com/v7/report-snapshots?reportId=5ec694ff90e5e6358d64c807"
          }
        ]
      }
    ],
    "dashboards": [
      {
        "title": "Microsoft 365 Global Status",
        "isDefaultForAccount": true,
        "widgets": [
          {
            "type": "Alert List",
            "title": "Microsoft 365 Global Operation Dashboard",
            "visualMode": "Full",
            "alertTypes": [
              "Voice - SIP Server",
              "DNS+ Server",
              "DNS Server",
              "DNSSEC",
              "Network - End-to-End (Agent)",
              "Web - HTTP Server",
              "DNS+ Domain",
              "Endpoint - Path Trace",
              "Voice - RTP Stream",
              "Web - FTP Server",
              "Network - End-to-End (Server)",
              "Device Interface",
              "DNS Trace",
              "Network - Path Trace",
              "Endpoint - End-to-End (Server)",
              "EndpointWeb - HTTP Server",
              "Web - Transaction (Classic)",
              "Web - Page Load",
              "Device",
              "Routing - BGP",
              "Web - Transaction"
            ],
            "limitTo": 25,
            "activeWithin": {
              "value": 1,
              "unit": "Hours"
            }
          },
          {
            "type": "Number",
            "title": " Microsoft 365 Global Availability - current",
            "visualMode": "Full",
            "numberCards": [
              {
                "description": "DNS Availability",
                "measure": {
                  "type": "% Inactive"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 30,
                  "unit": "Minutes"
                },
                "maxScale": 100.0,
                "dataSource": "Alerts",
                "metric": "Agent Alerts",
                "filters": {
                  "Test Labels": [
                    "DNS Resolution to Microsoft Online"
                  ]
                }
              },
              {
                "description": "Outlook Web Access",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 30,
                  "unit": "Minutes"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Availability",
                "filters": {
                  "Test Labels": [
                    "Outlook Online"
                  ]
                }
              },
              {
                "description": "Sharepoint Online Access",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 30,
                  "unit": "Minutes"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Availability",
                "filters": {
                  "Test Labels": [
                    "Sharepoint Online"
                  ]
                }
              },
              {
                "description": "OneDrive Online Access",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": false,
                "fixedTimespan": {
                  "value": 30,
                  "unit": "Minutes"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Availability",
                "filters": {
                  "Test Labels": [
                    "OneDrive Online"
                  ]
                }
              },
              {
                "description": "Office Applications Access",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 30,
                  "unit": "Minutes"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Availability",
                "filters": {
                  "Test Labels": [
                    "Office Online"
                  ]
                }
              },
              {
                "description": "OneNote Online Access",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": false,
                "fixedTimespan": {
                  "value": 30,
                  "unit": "Minutes"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Availability",
                "filters": {
                  "Test Labels": [
                    "OneNote Online"
                  ]
                }
              }
            ]
          },
          {
            "type": "Number",
            "title": " Microsoft 365 Global Availability - past 24 hours",
            "visualMode": "Full",
            "numberCards": [
              {
                "description": "Outlook Online Access",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Availability",
                "filters": {
                  "Test Labels": [
                    "Outlook Online"
                  ]
                }
              },
              {
                "description": "Sharepoint Online Access",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Availability",
                "filters": {
                  "Test Labels": [
                    "Sharepoint Online"
                  ]
                }
              },
              {
                "description": "OneDrive Online Access",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Availability",
                "filters": {
                  "Test Labels": [
                    "OneDrive Online"
                  ]
                }
              },
              {
                "description": "Office Applications Online Access",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Availability",
                "filters": {
                  "Test Labels": [
                    "Office Online"
                  ]
                }
              },
              {
                "description": "DNS Availability",
                "measure": {
                  "type": "% Inactive"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 100.0,
                "dataSource": "Alerts",
                "metric": "Agent Alerts",
                "filters": {
                  "Test Labels": [
                    "DNS Resolution to Microsoft Online"
                  ]
                }
              },
              {
                "description": "OneNote Online Access",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Availability",
                "filters": {
                  "Test Labels": [
                    "OneNote Online"
                  ]
                }
              }
            ]
          },
          {
            "type": "Number",
            "title": "Microsoft 365 Global Response Time - past 24 hours",
            "visualMode": "Full",
            "numberCards": [
              {
                "description": "Outlook Online Access",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 1000.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Response Time",
                "filters": {
                  "Test Labels": [
                    "Outlook Online"
                  ]
                }
              },
              {
                "description": "Sharepoint Online Access",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 1000.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Response Time",
                "filters": {
                  "Test Labels": [
                    "Sharepoint Online"
                  ]
                }
              },
              {
                "description": "OneDrive Online Access",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 1000.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Response Time",
                "filters": {
                  "Test Labels": [
                    "OneDrive Online"
                  ]
                }
              },
              {
                "description": "Office Applications Online Access",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 1000.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Response Time",
                "filters": {
                  "Test Labels": [
                    "Office Online"
                  ]
                }
              },
              {
                "description": "DNS Response Time to Microsoft Online",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 200.0,
                "dataSource": "CLOUD_AND_ENTERPRISE_AGENTS",
                "metricGroup": "DOMAIN_TRACE",
                "metric": "DNS_TRACE_QUERY_TIME",
                "filters": {
                  "Test Labels": [
                    "DNS Resolution to Microsoft Online"
                  ]
                }
              },
              {
                "description": "OneNote Online Access",
                "measure": {
                  "type": "Mean"
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 1,
                  "unit": "Days"
                },
                "maxScale": 1000.0,
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - HTTP Server",
                "metric": "Response Time",
                "filters": {
                  "Test Labels": [
                    "OneNote Online"
                  ]
                }
              }
            ]
          },
          {
            "type": "Number",
            "title": "Baseline Microsoft 365 Transaction Performance - past 14 Days",
            "visualMode": "Full",
            "numberCards": [
              {
                "description": "Microsoft Online Login",
                "measure": {
                  "type": "nth Percentile",
                  "percentileValue": 98.0
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 14,
                  "unit": "Days"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - Transactions",
                "metric": "Transaction Time",
                "filters": {
                  "Agent Labels": [
                    "Branch"
                  ],
                  "Test Labels": [
                    "Microsoft 365 Online"
                  ]
                }
              },
              {
                "description": "Outlook Send Mail",
                "measure": {
                  "type": "nth Percentile",
                  "percentileValue": 98.0
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 14,
                  "unit": "Days"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - Transactions",
                "metric": "Transaction Time",
                "filters": {
                  "Agent Labels": [
                    "Branch"
                  ],
                  "Test Labels": [
                    "Outlook Online"
                  ]
                }
              },
              {
                "description": "Sharepoint File Download",
                "measure": {
                  "type": "nth Percentile",
                  "percentileValue": 98.0
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 14,
                  "unit": "Days"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - Transactions",
                "metric": "Transaction Time",
                "filters": {
                  "Agent Labels": [
                    "Branch"
                  ],
                  "Test Labels": [
                    "Sharepoint Online"
                  ]
                }
              },
              {
                "description": "Office Applications Login",
                "measure": {
                  "type": "nth Percentile",
                  "percentileValue": 98.0
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 14,
                  "unit": "Days"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - Transactions",
                "metric": "Transaction Time",
                "filters": {
                  "Agent Labels": [
                    "Branch"
                  ],
                  "Test Labels": [
                    "Office Online"
                  ]
                }
              },
              {
                "description": "OneDrive File Download",
                "measure": {
                  "type": "nth Percentile",
                  "percentileValue": 98.0
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 14,
                  "unit": "Days"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - Transactions",
                "metric": "Transaction Time",
                "filters": {
                  "Agent Labels": [
                    "Branch"
                  ],
                  "Test Labels": [
                    "OneDrive Online"
                  ]
                }
              },
              {
                "description": "DNS Resolution Time to MS",
                "measure": {
                  "type": "nth Percentile",
                  "percentileValue": 90.0
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 14,
                  "unit": "Days"
                },
                "dataSource": "CLOUD_AND_ENTERPRISE_AGENTS",
                "metricGroup": "DOMAIN_TRACE",
                "metric": "DNS_TRACE_QUERY_TIME",
                "filters": {
                  "Agent Labels": [
                    "Branch"
                  ],
                  "Test Labels": [
                    "DNS Resolution to Microsoft Online"
                  ]
                }
              },
              {
                "description": "OneNote Online Login",
                "measure": {
                  "type": "nth Percentile",
                  "percentileValue": 98.0
                },
                "compareToPreviousValue": true,
                "fixedTimespan": {
                  "value": 14,
                  "unit": "Days"
                },
                "dataSource": "Cloud & Enterprise Agents",
                "metricGroup": "Web - Transactions",
                "metric": "Transaction Time",
                "filters": {
                  "Agent Labels": [
                    "Branch"
                  ],
                  "Test Labels": [
                    "OneNote Online"
                  ]
                }
              }
            ]
          },
          {
            "type": "Color Grid",
            "title": "Microsoft 365 Overall Status - Availability per Site",
            "visualMode": "Full",
            "dataSource": "Cloud & Enterprise Agents",
            "metricGroup": "Web - HTTP Server",
            "metric": "Availability",
            "measure": {
              "type": "nth Percentile",
              "percentileValue": 98.0
            },
            "filters": {
              "Agent Labels": [
                "Branch"
              ]
            },
            "fixedTimespan": {
              "value": 5,
              "unit": "Minutes"
            },
            "cards": "Agents",
            "groupCardsBy": "Tests",
            "maxScale": 100.0,
            "columns": 2,
            "sortBy": "Alphabetical",
            "sortDirection": "Ascending"
          },
          {
            "forEach": "$formAgents",
            "loop": {
              "type": "Number",
              "title": "Microsoft 365 Status by Site - $formAgents.name",
              "visualMode": "Full",
              "numberCards": [
                {
                  "description": "Microsoft 365 Login",
                  "measure": {
                    "type": "Mean"
                  },
                  "compareToPreviousValue": false,
                  "fixedTimespan": {
                    "value": 1,
                    "unit": "Days"
                  },
                  "maxScale": 20000.0,
                  "dataSource": "Cloud & Enterprise Agents",
                  "metricGroup": "Web - Transactions",
                  "metric": "Transaction Time",
                  "filters": {
                    "Test Labels": [
                      "Microsoft 365 Online"
                    ],
                    "Sources": [
                      "$formAgents.id"
                    ]
                  }
                },
                {
                  "description": "Sharepoint File Download",
                  "measure": {
                    "type": "Mean"
                  },
                  "compareToPreviousValue": false,
                  "fixedTimespan": {
                    "value": 1,
                    "unit": "Days"
                  },
                  "maxScale": 36000.0,
                  "dataSource": "Cloud & Enterprise Agents",
                  "metricGroup": "Web - Transactions",
                  "metric": "Transaction Time",
                  "filters": {
                    "Test Labels": [
                      "Sharepoint Online"
                    ],
                    "Sources": [
                      "$formAgents.id"
                    ]
                  }
                },
                {
                  "description": "OneDrive File Download",
                  "measure": {
                    "type": "Mean"
                  },
                  "compareToPreviousValue": false,
                  "fixedTimespan": {
                    "value": 1,
                    "unit": "Days"
                  },
                  "maxScale": 38000.0,
                  "dataSource": "Cloud & Enterprise Agents",
                  "metricGroup": "Web - Transactions",
                  "metric": "Transaction Time",
                  "filters": {
                    "Test Labels": [
                      "OneDrive Online"
                    ],
                    "Sources": [
                      "$formAgents.id"
                    ]
                  }
                },
                {
                  "description": "OneNote Online Access",
                  "measure": {
                    "type": "Mean"
                  },
                  "compareToPreviousValue": false,
                  "fixedTimespan": {
                    "value": 1,
                    "unit": "Days"
                  },
                  "maxScale": 20000.0,
                  "dataSource": "Cloud & Enterprise Agents",
                  "metricGroup": "Web - Transactions",
                  "metric": "Transaction Time",
                  "filters": {
                    "Test Labels": [
                      "OneNote Online"
                    ],
                    "Sources": [
                      "$formAgents.id"
                    ]
                  }
                },
                {
                  "description": "Office 365 Application Access",
                  "measure": {
                    "type": "Mean"
                  },
                  "compareToPreviousValue": false,
                  "fixedTimespan": {
                    "value": 1,
                    "unit": "Days"
                  },
                  "maxScale": 15000.0,
                  "dataSource": "Cloud & Enterprise Agents",
                  "metricGroup": "Web - Transactions",
                  "metric": "Transaction Time",
                  "filters": {
                    "Test Labels": [
                      "Office Online"
                    ],
                    "Sources": [
                      "$formAgents.id"
                    ]
                  }
                },
                {
                  "description": "Outlook Send mail",
                  "measure": {
                    "type": "Mean"
                  },
                  "compareToPreviousValue": false,
                  "fixedTimespan": {
                    "value": 1,
                    "unit": "Days"
                  },
                  "maxScale": 50000.0,
                  "dataSource": "Cloud & Enterprise Agents",
                  "metricGroup": "Web - Transactions",
                  "metric": "Transaction Time",
                  "filters": {
                    "Test Labels": [
                      "Outlook Online"
                    ],
                    "Sources": [
                      "$formAgents.id"
                    ]
                  }
                },
                {
                  "description": "DNS Resolution to Microsoft 365",
                  "measure": {
                    "type": "Mean"
                  },
                  "compareToPreviousValue": false,
                  "fixedTimespan": {
                    "value": 1,
                    "unit": "Days"
                  },
                  "maxScale": 200.0,
                  "dataSource": "CLOUD_AND_ENTERPRISE_AGENTS",
                  "metricGroup": "DOMAIN_TRACE",
                  "metric": "DNS_TRACE_QUERY_TIME",
                  "filters": {
                    "Test Labels": [
                      "DNS Resolution to Microsoft Online"
                    ],
                    "Sources": [
                      "$formAgents.id"
                    ]
                  }
                }
              ]
            }
          },
          {
            "type": "Test Table",
            "title": "Microsoft 365 Status - past 12 hours",
            "fixedTimespan": {
              "value": 12,
              "unit": "Hours"
            },
            "shouldExcludeAlertSuppressionWindows": false,
            "filter": {
              "filters": [],
              "type": "all"
            },
            "exclude": {
              "filters": [],
              "type": "all"
            }
          }
        ]
      }
    ]
  }
}
